<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Cat vs Fish ‚Äî Tic Tac Toe</title>
    <meta name="description" content="A playful green, cartoony Tic-Tac-Toe: Cats (X) vs Fish (O)">
    <style>
      :root {
        color-scheme: light;
        --bg: #e6ffe6;
        --panel: #ffffff;
        --ink: #143d14;
        --ink-soft: #2a6a2a;
        --accent: #27ae60;
        --accent-2: #a3e635;
        --grid: #66bb6a;
        --shadow: 0 8px 30px rgba(20, 61, 20, 0.15);
        --radius: 16px;
      }

      * { box-sizing: border-box; }
      html, body { height: 100%; margin: 0; }
      body {
        display: grid;
        place-items: center;
        background:
          radial-gradient(1200px 700px at -10% -10%, #f1fff1 0%, transparent 60%),
          radial-gradient(900px 600px at 110% 0%, #f0ffe6 0%, transparent 50%),
          var(--bg);
        font-family: "Comic Sans MS", "Comic Sans", ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
        color: var(--ink);
        line-height: 1.5;
        padding: 24px;
      }

      .app {
        width: min(90vw, 720px);
        background: var(--panel);
        border-radius: var(--radius);
        box-shadow: var(--shadow);
        padding: 24px;
        border: 3px solid var(--accent-2);
        position: relative;
        overflow: hidden;
      }

      .title {
        display: flex;
        align-items: center;
        gap: 12px;
        margin: 0 0 12px 0;
        font-size: 28px;
        text-shadow: 0 2px 0 #c8f7c5;
      }

      .title .badge {
        font-size: 22px;
        background: linear-gradient(0deg, #b9fbc0, #cfff95);
        border: 2px solid var(--grid);
        border-radius: 999px;
        padding: 4px 10px;
      }

      .subtitle { margin: 0 0 18px 0; color: var(--ink-soft); }

      .board {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 10px;
        width: 100%;
        aspect-ratio: 1 / 1;
        margin: 12px 0 16px;
      }

      .cell {
        display: grid;
        place-items: center;
        background: linear-gradient(0deg, #eaffea, #ffffff);
        border: 3px solid var(--grid);
        border-radius: 18px;
        font-size: clamp(44px, 10vw, 82px);
        cursor: pointer;
        user-select: none;
        transition: transform 120ms ease, box-shadow 120ms ease, background 160ms ease;
        box-shadow: 0 6px 0 #9be49b, 0 10px 20px rgba(20,61,20,0.08);
      }

      .cell:active { transform: translateY(2px); box-shadow: 0 4px 0 #9be49b; }
      .cell[disabled] { cursor: not-allowed; opacity: 0.7; }

      .symbols {
        display: flex;
        gap: 8px;
        align-items: center;
        color: var(--ink-soft);
        font-size: 18px;
      }

      .pill {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        background: #d9f99d;
        border: 2px dashed var(--accent);
        padding: 4px 10px;
        border-radius: 999px;
      }

      .row { display: flex; align-items: center; justify-content: space-between; gap: 12px; }

      .status {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        padding: 8px 12px;
        background: #ebffe1;
        border: 2px solid var(--accent-2);
        border-radius: 12px;
        font-weight: 700;
      }

      .btns { display: flex; gap: 10px; }
      .button {
        appearance: none;
        border: 0;
        background: linear-gradient(0deg, #34d399, #a7f3d0);
        color: #0f291e;
        border: 3px solid #10b981;
        font-weight: 800;
        padding: 10px 14px;
        border-radius: 12px;
        cursor: pointer;
        box-shadow: 0 6px 0 #86efac;
        transition: transform 120ms ease, box-shadow 120ms ease;
      }
      .button:active { transform: translateY(2px); box-shadow: 0 4px 0 #86efac; }

      .celebrate {
        position: absolute;
        inset: -10% -10% auto auto;
        width: 220px;
        height: 220px;
        pointer-events: none;
        opacity: 0.15;
        filter: saturate(1.3);
      }

      @media (max-width: 520px) {
        .row { flex-direction: column; align-items: stretch; }
        .btns { width: 100%; }
        .button { flex: 1; }
      }
    </style>
  </head>
  <body>
    <div class="app" role="application" aria-label="Cat vs Fish Tic Tac Toe">
      <svg class="celebrate" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
        <defs>
          <linearGradient id="g" x1="0" y1="0" x2="1" y2="1">
            <stop offset="0%" stop-color="#bbf7d0"/>
            <stop offset="100%" stop-color="#86efac"/>
          </linearGradient>
        </defs>
        <circle cx="100" cy="100" r="90" fill="url(#g)"/>
      </svg>

      <h1 class="title">
        üê± vs üêü
        <span class="badge">Tic Tac Toe</span>
      </h1>
      <p class="subtitle">Cats are X, Fish are O. First to line up three wins!</p>

      <div class="row" style="margin-bottom: 8px;">
        <div class="symbols">
          <span class="pill" title="X"><span>üê±</span><span>X</span></span>
          <span class="pill" title="O"><span>üêü</span><span>O</span></span>
        </div>
        <div id="status" class="status" aria-live="polite">Turn: üê±</div>
        <div class="btns">
          <button id="reset" class="button" type="button">Reset</button>
          <button class="button" onclick="location.href='settings.html'" type="button">‚öôÔ∏è Settings</button>
        </div>
      </div>

      <div style="display: grid; grid-template-columns: 1fr min(200px, 35%); gap: 16px; align-items: start;">
        <div id="board" class="board" role="grid" aria-label="Game board" aria-describedby="status"></div>
        <nav aria-label="More games" style="display: grid; gap: 10px;">
          <button id="nav-mini-1" class="button" onclick="location.href='fish.html'" type="button">üê±üé£ Catch Fish</button>
          <button id="nav-mini-2" class="button" onclick="location.href='hidden.html'" type="button">üîéüê± Find Hidden Cats</button>
          <button class="button" onclick="location.href='stats.html'" type="button">üìä Wins & Losses</button>
        </nav>
      </div>
    </div>

    <script>
      (function () {
        // Load mode and theme
        const mode = localStorage.getItem('tttSymbolsMode') || 'cats';
        const theme = localStorage.getItem('tttTheme') || (mode==='dogs' ? 'blue' : 'green');
        const SYMBOLS = mode==='dogs' ? { X: 'üê∂', O: 'ü¶¥' } : { X: 'üê±', O: 'üêü' };
        const CAT = SYMBOLS.X; // X
        const FISH = SYMBOLS.O; // O

        // Apply theme variables if blue
        if (theme === 'blue') {
          const root = document.documentElement;
          root.style.setProperty('--bg', '#e6f2ff');
          root.style.setProperty('--panel', '#ffffff');
          root.style.setProperty('--ink', '#0f2b46');
          root.style.setProperty('--ink-soft', '#2a4d6a');
          root.style.setProperty('--accent', '#1d4ed8');
          root.style.setProperty('--accent-2', '#93c5fd');
          root.style.setProperty('--grid', '#60a5fa');
        }

        /**
         * Game state
         */
        let currentPlayer = CAT; // CAT starts
        let boardState = Array(9).fill(null);
        let gameOver = false;

        const board = document.getElementById("board");
        const statusEl = document.getElementById("status");
        const resetButton = document.getElementById("reset");

        // Update UI labels per mode
        (function updateLabels(){
          const pills = document.querySelectorAll('.pill');
          if (pills[0]) { pills[0].innerHTML = `<span>${CAT}</span><span>X</span>`; }
          if (pills[1]) { pills[1].innerHTML = `<span>${FISH}</span><span>O</span>`; }
          const subtitle = document.querySelector('.subtitle');
          if (subtitle) subtitle.textContent = `${CAT} are X, ${FISH} are O. First to line up three wins!`;
          const nav1 = document.getElementById('nav-mini-1');
          const nav2 = document.getElementById('nav-mini-2');
          if (mode==='dogs') {
            if (nav1) nav1.textContent = 'üê∂ü¶¥ Catch Bones';
            if (nav2) nav2.textContent = 'üîéüê∂ Find Hidden Dogs';
          } else {
            if (nav1) nav1.textContent = 'üê±üé£ Catch Fish';
            if (nav2) nav2.textContent = 'üîéüê± Find Hidden Cats';
          }
        })();

        /** Create board cells */
        function renderBoard() {
          board.innerHTML = "";
          for (let index = 0; index < 9; index++) {
            const button = document.createElement("button");
            button.className = "cell";
            button.setAttribute("role", "gridcell");
            button.setAttribute("aria-label", `Cell ${index + 1}`);
            button.dataset.index = String(index);
            button.textContent = boardState[index] || "";
            button.addEventListener("click", onCellClick, { passive: true });
            board.appendChild(button);
          }
        }

        /** Handle a cell click */
        function onCellClick(event) {
          if (gameOver) return;
          const cell = event.currentTarget;
          const index = Number(cell.dataset.index);
          if (boardState[index]) return; // already taken

          // Place symbol for current player
          boardState[index] = currentPlayer;
          cell.textContent = currentPlayer;

          // Check for win or draw
          const winner = getWinner(boardState);
          if (winner) {
            setStatus(`${winner} wins!`);
            updateStatsOnWin(winner);
            endGame();
            return;
          }

          if (boardState.every(Boolean)) {
            setStatus("It's a draw!");
            updateStatsOnDraw();
            endGame();
            return;
          }

          // Swap player
          currentPlayer = currentPlayer === CAT ? FISH : CAT;
          setStatus(`Turn: ${currentPlayer}`);
        }

        /** Determine winner given a board array */
        function getWinner(cells) {
          const lines = [
            [0, 1, 2],
            [3, 4, 5],
            [6, 7, 8],
            [0, 3, 6],
            [1, 4, 7],
            [2, 5, 8],
            [0, 4, 8],
            [2, 4, 6]
          ];
          for (const [a, b, c] of lines) {
            if (cells[a] && cells[a] === cells[b] && cells[a] === cells[c]) {
              highlightWin([a, b, c]);
              return cells[a];
            }
          }
          return null;
        }

        /** Highlight winning cells */
        function highlightWin(indices) {
          const cellButtons = board.querySelectorAll(".cell");
          indices.forEach((i) => {
            const el = cellButtons[i];
            el.style.background = "linear-gradient(0deg, #ccffcc, #eaffea)";
            el.style.borderColor = "#10b981";
            el.style.transform = "scale(1.02)";
          });
        }

        /** Update status area */
        function setStatus(text) {
          statusEl.textContent = text;
        }

        /** Disable further play */
        function endGame() {
          gameOver = true;
          const buttons = board.querySelectorAll(".cell");
          buttons.forEach((btn) => btn.setAttribute("disabled", "true"));
        }

        /** Stats helpers stored in localStorage */
        function getNumber(key) {
          const value = localStorage.getItem(key);
          const num = value == null ? 0 : Number(value);
          return Number.isFinite(num) ? num : 0;
        }

        function setNumber(key, value) {
          localStorage.setItem(key, String(value));
        }

        function updateStatsOnWin(winnerSymbol) {
          const totalGames = getNumber("tttGames") + 1;
          setNumber("tttGames", totalGames);
          if (winnerSymbol === CAT) {
            setNumber("tttWinsCat", getNumber("tttWinsCat") + 1);
          } else if (winnerSymbol === FISH) {
            setNumber("tttWinsFish", getNumber("tttWinsFish") + 1);
          }
        }

        function updateStatsOnDraw() {
          const totalGames = getNumber("tttGames") + 1;
          setNumber("tttGames", totalGames);
          setNumber("tttDraws", getNumber("tttDraws") + 1);
        }

        /** Reset the game */
        function resetGame() {
          currentPlayer = CAT;
          boardState = Array(9).fill(null);
          gameOver = false;
          setStatus(`Turn: ${currentPlayer}`);
          renderBoard();
        }

        resetButton.addEventListener("click", resetGame);

        // Initialize
        renderBoard();
        setStatus(`Turn: ${currentPlayer}`);
      })();
    </script>
  </body>
  </html>
