// Translations
const translations = {
    en: {
        home: "Home",
        books: "Books",
        about: "About",
        contact: "Contact",
        login: "Login",
        signup: "Signup",
        logout: "Logout",
        welcome: "Welcome to DreamShelf Library â€” Read. Learn. Grow.",
        explore: "Explore our vast collection of books from around the world.",
        browse: "Browse Books",
        ourBooks: "Our Books",
        searchPlaceholder: "Search books...",
        adminPanel: "Admin Panel",
        aboutText: "DreamShelf Library is a modern digital library dedicated to providing access to literature and knowledge for everyone. Our mission is to make reading accessible, enjoyable, and convenient for people of all ages.",
        aboutText2: "Founded in 2023, we've grown to include thousands of titles across multiple genres, from classic literature to contemporary bestsellers.",
        address: "Address:",
        phone: "Phone:",
        email: "Email:",
        facebook: "Facebook",
        twitter: "Twitter",
        instagram: "Instagram",
        fullName: "Full Name",
        confirmPassword: "Confirm Password",
        agree: "I agree to the terms and conditions",
        noAccount: "Don't have an account?",
        haveAccount: "Already have an account?",
        footerText: "Your gateway to knowledge and imagination.",
        follow: "Follow Us",
        rights: "All rights reserved.",
        title: "Title",
        author: "Author",
        price: "Price ($)",
        imageUrl: "Image URL",
        addBook: "Add Book",
        editBook: "Edit Book",
        saveChanges: "Save Changes",
        forgotPassword: "Forgot Password?",
        deleteConfirm: "Are you sure you want to delete this book?"
    },
    pt: {
        home: "InÃ­cio",
        books: "Livros",
        about: "Sobre",
        contact: "Contato",
        login: "Entrar",
        signup: "Cadastrar",
        logout: "Sair",
        welcome: "Bem-vindo Ã  Biblioteca DreamShelf â€” Leia. Aprenda. CresÃ§a.",
        explore: "Explore nossa vasta coleÃ§Ã£o de livros do mundo todo.",
        browse: "Navegar pelos Livros",
        ourBooks: "Nossos Livros",
        searchPlaceholder: "Pesquisar livros...",
        adminPanel: "Painel do Administrador",
        aboutText: "A Biblioteca DreamShelf Ã© uma biblioteca digital moderna dedicada a fornecer acesso Ã  literatura e ao conhecimento para todos. Nossa missÃ£o Ã© tornar a leitura acessÃ­vel, agradÃ¡vel e conveniente para pessoas de todas as idades.",
        aboutText2: "Fundada em 2023, crescemos para incluir milhares de tÃ­tulos em vÃ¡rios gÃªneros, desde literatura clÃ¡ssica atÃ© best-sellers contemporÃ¢neos.",
        address: "EndereÃ§o:",
        phone: "Telefone:",
        email: "E-mail:",
        facebook: "Facebook",
        twitter: "Twitter",
        instagram: "Instagram",
        fullName: "Nome Completo",
        confirmPassword: "Confirmar Senha",
        agree: "Concordo com os termos e condiÃ§Ãµes",
        noAccount: "NÃ£o tem uma conta?",
        haveAccount: "JÃ¡ tem uma conta?",
        footerText: "Sua porta de entrada para o conhecimento e a imaginaÃ§Ã£o.",
        follow: "Siga-nos",
        rights: "Todos os direitos reservados.",
        title: "TÃ­tulo",
        author: "Autor",
        price: "PreÃ§o (R$)",
        imageUrl: "URL da Imagem",
        addBook: "Adicionar Livro",
        editBook: "Editar Livro",
        saveChanges: "Salvar AlteraÃ§Ãµes",
        forgotPassword: "Esqueceu a Senha?",
        deleteConfirm: "Tem certeza de que deseja excluir este livro?"
    },
    tr: {
        home: "Ana Sayfa",
        books: "Kitaplar",
        about: "HakkÄ±nda",
        contact: "Ä°letiÅŸim",
        login: "GiriÅŸ Yap",
        signup: "KayÄ±t Ol",
        logout: "Ã‡Ä±kÄ±ÅŸ Yap",
        welcome: "DreamShelf KÃ¼tÃ¼phanesine HoÅŸ Geldiniz â€” Okuyun. Ã–ÄŸrenin. BÃ¼yÃ¼yÃ¼n.",
        explore: "DÃ¼nyanÄ±n dÃ¶rt bir yanÄ±ndan kitap koleksiyonumuzu keÅŸfedin.",
        browse: "Kitaplara GÃ¶zat",
        ourBooks: "KitaplarÄ±mÄ±z",
        searchPlaceholder: "Kitap ara...",
        adminPanel: "YÃ¶netici Paneli",
        aboutText: "DreamShelf KÃ¼tÃ¼phanesi, herkese edebiyat ve bilgiye eriÅŸim saÄŸlamak iÃ§in adanmÄ±ÅŸ modern bir dijital kÃ¼tÃ¼phanedir. Misyonumuz, okumayÄ± her yaÅŸ grubu iÃ§in eriÅŸilebilir, keyifli ve uygun hale getirmektir.",
        aboutText2: "2023 yÄ±lÄ±nda kurulan kÃ¼tÃ¼phanemiz, klasik edebiyattan Ã§aÄŸdaÅŸ Ã§ok satanlara kadar birÃ§ok tÃ¼rde binlerce baÅŸlÄ±k bÃ¼nyesinde barÄ±ndÄ±rmaktadÄ±r.",
        address: "Adres:",
        phone: "Telefon:",
        email: "E-posta:",
        facebook: "Facebook",
        twitter: "Twitter",
        instagram: "Instagram",
        fullName: "Tam Ad",
        confirmPassword: "Åžifreyi Onayla",
        agree: "Åžartlar ve koÅŸullarÄ± kabul ediyorum",
        noAccount: "HesabÄ±nÄ±z yok mu?",
        haveAccount: "Zaten bir hesabÄ±nÄ±z var mÄ±?",
        footerText: "Bilgi ve hayal gÃ¼cÃ¼nÃ¼ze aÃ§Ä±lan kapÄ±nÄ±z.",
        follow: "Bizi Takip Edin",
        rights: "TÃ¼m haklarÄ± saklÄ±dÄ±r.",
        title: "BaÅŸlÄ±k",
        author: "Yazar",
        price: "Fiyat (â‚º)",
        imageUrl: "Resim URL",
        addBook: "Kitap Ekle",
        editBook: "KitabÄ± DÃ¼zenle",
        saveChanges: "DeÄŸiÅŸiklikleri Kaydet",
        forgotPassword: "Åžifremi Unuttum?",
        deleteConfirm: "Bu kitabÄ± silmek istediÄŸinizden emin misiniz?"
    },
    es: {
        home: "Inicio",
        books: "Libros",
        about: "Acerca de",
        contact: "Contacto",
        login: "Iniciar sesiÃ³n",
        signup: "Registrarse",
        logout: "Cerrar sesiÃ³n",
        welcome: "Bienvenido a la Biblioteca DreamShelf â€” Lee. Aprende. Crece.",
        explore: "Explora nuestra vasta colecciÃ³n de libros de todo el mundo.",
        browse: "Explorar libros",
        ourBooks: "Nuestros libros",
        searchPlaceholder: "Buscar libros...",
        adminPanel: "Panel de administraciÃ³n",
        aboutText: "La Biblioteca DreamShelf es una biblioteca digital moderna dedicada a proporcionar acceso a la literatura y el conocimiento para todos. Nuestra misiÃ³n es hacer que la lectura sea accesible, disfrutable y conveniente para personas de todas las edades.",
        aboutText2: "Fundada en 2023, hemos crecido para incluir miles de tÃ­tulos en mÃºltiples gÃ©neros, desde literatura clÃ¡sica hasta superventas contemporÃ¡neas.",
        address: "DirecciÃ³n:",
        phone: "TelÃ©fono:",
        email: "Correo electrÃ³nico:",
        facebook: "Facebook",
        twitter: "Twitter",
        instagram: "Instagram",
        fullName: "Nombre completo",
        confirmPassword: "Confirmar contraseÃ±a",
        agree: "Acepto los tÃ©rminos y condiciones",
        noAccount: "Â¿No tienes cuenta?",
        haveAccount: "Â¿Ya tienes cuenta?",
        footerText: "Tu puerta de entrada al conocimiento y la imaginaciÃ³n.",
        follow: "SÃ­guenos",
        rights: "Todos los derechos reservados.",
        title: "TÃ­tulo",
        author: "Autor",
        price: "Precio ($)",
        imageUrl: "URL de imagen",
        addBook: "Agregar libro",
        editBook: "Editar libro",
        saveChanges: "Guardar cambios",
        forgotPassword: "Â¿Olvidaste tu contraseÃ±a?",
        deleteConfirm: "Â¿EstÃ¡s seguro de que quieres eliminar este libro?"
    },
    fr: {
        home: "Accueil",
        books: "Livres",
        about: "Ã€ propos",
        contact: "Contact",
        login: "Connexion",
        signup: "S'inscrire",
        logout: "Se dÃ©connecter",
        welcome: "Bienvenue Ã  la bibliothÃ¨que DreamShelf â€” Lisez. Apprenez. Grandissez.",
        explore: "Explorez notre vaste collection de livres du monde entier.",
        browse: "Parcourir les livres",
        ourBooks: "Nos livres",
        searchPlaceholder: "Rechercher des livres...",
        adminPanel: "Panneau d'administration",
        aboutText: "La bibliothÃ¨que DreamShelf est une bibliothÃ¨que numÃ©rique moderne dÃ©diÃ©e Ã  fournir un accÃ¨s Ã  la littÃ©rature et au savoir pour tous. Notre mission est de rendre la lecture accessible, agrÃ©able et pratique pour les personnes de tous Ã¢ges.",
        aboutText2: "FondÃ©e en 2023, nous avons grandi pour inclure des milliers de titres dans plusieurs genres, de la littÃ©rature classique aux best-sellers contemporains.",
        address: "Adresse:",
        phone: "TÃ©lÃ©phone:",
        email: "E-mail:",
        facebook: "Facebook",
        twitter: "Twitter",
        instagram: "Instagram",
        fullName: "Nom complet",
        confirmPassword: "Confirmer le mot de passe",
        agree: "J'accepte les termes et conditions",
        noAccount: "Vous n'avez pas de compte?",
        haveAccount: "Vous avez dÃ©jÃ  un compte?",
        footerText: "Votre porte d'entrÃ©e vers le savoir et l'imagination.",
        follow: "Suivez-nous",
        rights: "Tous droits rÃ©servÃ©s.",
        title: "Titre",
        author: "Auteur",
        price: "Prix ($)",
        imageUrl: "URL de l'image",
        addBook: "Ajouter un livre",
        editBook: "Modifier le livre",
        saveChanges: "Enregistrer les modifications",
        forgotPassword: "Mot de passe oubliÃ©?",
        deleteConfirm: "ÃŠtes-vous sÃ»r de vouloir supprimer ce livre?"
    },
    hi: {
        home: "à¤¹à¥‹à¤®",
        books: "à¤ªà¥à¤¸à¥à¤¤à¤•à¥‡à¤‚",
        about: "à¤¹à¤®à¤¾à¤°à¥‡ à¤¬à¤¾à¤°à¥‡ à¤®à¥‡à¤‚",
        contact: "à¤¸à¤‚à¤ªà¤°à¥à¤• à¤•à¤°à¥‡à¤‚",
        login: "à¤²à¥‰à¤— à¤‡à¤¨ à¤•à¤°à¥‡à¤‚",
        signup: "à¤¸à¤¾à¤‡à¤¨ à¤…à¤ª à¤•à¤°à¥‡à¤‚",
        logout: "à¤²à¥‰à¤— à¤†à¤‰à¤Ÿ",
        welcome: "DreamShelf à¤ªà¥à¤¸à¥à¤¤à¤•à¤¾à¤²à¤¯ à¤®à¥‡à¤‚ à¤†à¤ªà¤•à¤¾ à¤¸à¥à¤µà¤¾à¤—à¤¤ à¤¹à¥ˆ â€” à¤ªà¤¢à¤¼à¥‡à¤‚à¥¤ à¤¸à¥€à¤–à¥‡à¤‚à¥¤ à¤¬à¤¢à¤¼à¥‡à¤‚à¥¤",
        explore: "à¤¦à¥à¤¨à¤¿à¤¯à¤¾ à¤­à¤° à¤•à¥€ à¤ªà¥à¤¸à¥à¤¤à¤•à¥‹à¤‚ à¤•à¥‡ à¤¹à¤®à¤¾à¤°à¥‡ à¤µà¤¿à¤¶à¤¾à¤² à¤¸à¤‚à¤—à¥à¤°à¤¹ à¤•à¤¾ à¤…à¤¨à¥à¤µà¥‡à¤·à¤£ à¤•à¤°à¥‡à¤‚à¥¤",
        browse: "à¤ªà¥à¤¸à¥à¤¤à¤•à¥‡à¤‚ à¤¬à¥à¤°à¤¾à¤‰à¤œà¤¼ à¤•à¤°à¥‡à¤‚",
        ourBooks: "à¤¹à¤®à¤¾à¤°à¥€ à¤ªà¥à¤¸à¥à¤¤à¤•à¥‡à¤‚",
        searchPlaceholder: "à¤ªà¥à¤¸à¥à¤¤à¤•à¥‡à¤‚ à¤–à¥‹à¤œà¥‡à¤‚...",
        adminPanel: "à¤µà¥à¤¯à¤µà¤¸à¥à¤¥à¤¾à¤ªà¤• à¤ªà¥ˆà¤¨à¤²",
        aboutText: "DreamShelf à¤ªà¥à¤¸à¥à¤¤à¤•à¤¾à¤²à¤¯ à¤à¤• à¤†à¤§à¥à¤¨à¤¿à¤• à¤¡à¤¿à¤œà¤¿à¤Ÿà¤² à¤ªà¥à¤¸à¥à¤¤à¤•à¤¾à¤²à¤¯ à¤¹à¥ˆ à¤œà¥‹ à¤¸à¤­à¥€ à¤•à¥‡ à¤²à¤¿à¤ à¤¸à¤¾à¤¹à¤¿à¤¤à¥à¤¯ à¤”à¤° à¤œà¥à¤žà¤¾à¤¨ à¤¤à¤• à¤ªà¤¹à¥à¤‚à¤š à¤ªà¥à¤°à¤¦à¤¾à¤¨ à¤•à¤°à¤¨à¥‡ à¤•à¥‡ à¤²à¤¿à¤ à¤¸à¤®à¤°à¥à¤ªà¤¿à¤¤ à¤¹à¥ˆà¥¤ à¤¹à¤®à¤¾à¤°à¤¾ à¤®à¤¿à¤¶à¤¨ à¤²à¥‹à¤—à¥‹à¤‚ à¤•à¥‡ à¤¸à¤­à¥€ à¤‰à¤®à¥à¤° à¤µà¤°à¥à¤—à¥‹à¤‚ à¤•à¥‡ à¤²à¤¿à¤ à¤ªà¤¢à¤¼à¤¨à¥‡ à¤•à¥‹ à¤¸à¥à¤²à¤­, à¤†à¤¨à¤‚à¤¦à¤¦à¤¾à¤¯à¤• à¤”à¤° à¤¸à¥à¤µà¤¿à¤§à¤¾à¤œà¤¨à¤• à¤¬à¤¨à¤¾à¤¨à¤¾ à¤¹à¥ˆà¥¤",
        aboutText2: "2023 à¤®à¥‡à¤‚ à¤¸à¥à¤¥à¤¾à¤ªà¤¿à¤¤, à¤¹à¤®à¤¨à¥‡ à¤•à¤ˆ à¤¶à¥ˆà¤²à¤¿à¤¯à¥‹à¤‚ à¤®à¥‡à¤‚ à¤¹à¤œà¤¾à¤°à¥‹à¤‚ à¤¶à¥€à¤°à¥à¤·à¤• à¤¶à¤¾à¤®à¤¿à¤² à¤•à¤°à¤¨à¥‡ à¤•à¥‡ à¤²à¤¿à¤ à¤µà¤¿à¤•à¤¸à¤¿à¤¤ à¤•à¤¿à¤¯à¤¾ à¤¹à¥ˆ, à¤•à¥à¤²à¤¾à¤¸à¤¿à¤• à¤¸à¤¾à¤¹à¤¿à¤¤à¥à¤¯ à¤¸à¥‡ à¤²à¥‡à¤•à¤° à¤¸à¤®à¤•à¤¾à¤²à¥€à¤¨ à¤¬à¥‡à¤¸à¥à¤Ÿà¤¸à¥‡à¤²à¤°à¥à¤¸ à¤¤à¤•à¥¤",
        address: "à¤ªà¤¤à¤¾:",
        phone: "à¤«à¤¼à¥‹à¤¨:",
        email: "à¤ˆà¤®à¥‡à¤²:",
        facebook: "à¤«à¥‡à¤¸à¤¬à¥à¤•",
        twitter: "à¤Ÿà¥à¤µà¤¿à¤Ÿà¤°",
        instagram: "à¤‡à¤‚à¤¸à¥à¤Ÿà¤¾à¤—à¥à¤°à¤¾à¤®",
        fullName: "à¤ªà¥‚à¤°à¤¾ à¤¨à¤¾à¤®",
        confirmPassword: "à¤ªà¤¾à¤¸à¤µà¤°à¥à¤¡ à¤•à¥€ à¤ªà¥à¤·à¥à¤Ÿà¤¿ à¤•à¤°à¥‡à¤‚",
        agree: "à¤®à¥ˆà¤‚ à¤¨à¤¿à¤¯à¤® à¤”à¤° à¤¶à¤°à¥à¤¤à¥‹à¤‚ à¤¸à¥‡ à¤¸à¤¹à¤®à¤¤ à¤¹à¥‚à¤‚",
        noAccount: "à¤•à¥‹à¤ˆ à¤–à¤¾à¤¤à¤¾ à¤¨à¤¹à¥€à¤‚ à¤¹à¥ˆ?",
        haveAccount: "à¤ªà¤¹à¤²à¥‡ à¤¸à¥‡ à¤¹à¥€ à¤à¤• à¤–à¤¾à¤¤à¤¾ à¤¹à¥ˆ?",
        footerText: "à¤œà¥à¤žà¤¾à¤¨ à¤”à¤° à¤•à¤²à¥à¤ªà¤¨à¤¾ à¤•à¥‡ à¤²à¤¿à¤ à¤†à¤ªà¤•à¤¾ à¤—à¥‡à¤Ÿà¤µà¥‡à¥¤",
        follow: "à¤¹à¤®à¥‡à¤‚ à¤«à¥‰à¤²à¥‹ à¤•à¤°à¥‡à¤‚",
        rights: "à¤¸à¤°à¥à¤µà¤¾à¤§à¤¿à¤•à¤¾à¤° à¤¸à¥à¤°à¤•à¥à¤·à¤¿à¤¤à¥¤",
        title: "à¤¶à¥€à¤°à¥à¤·à¤•",
        author: "à¤²à¥‡à¤–à¤•",
        price: "à¤®à¥‚à¤²à¥à¤¯ ($)",
        imageUrl: "à¤›à¤µà¤¿ URL",
        addBook: "à¤ªà¥à¤¸à¥à¤¤à¤• à¤œà¥‹à¤¡à¤¼à¥‡à¤‚",
        editBook: "à¤ªà¥à¤¸à¥à¤¤à¤• à¤¸à¤‚à¤ªà¤¾à¤¦à¤¿à¤¤ à¤•à¤°à¥‡à¤‚",
        saveChanges: "à¤ªà¤°à¤¿à¤µà¤°à¥à¤¤à¤¨à¥‹à¤‚ à¤•à¥‹ à¤¸à¥à¤°à¤•à¥à¤·à¤¿à¤¤ à¤•à¤°à¥‡à¤‚",
        forgotPassword: "à¤ªà¤¾à¤¸à¤µà¤°à¥à¤¡ à¤­à¥‚à¤² à¤—à¤?",
        deleteConfirm: "à¤•à¥à¤¯à¤¾ à¤†à¤ª à¤µà¤¾à¤•à¤ˆ à¤‡à¤¸ à¤ªà¥à¤¸à¥à¤¤à¤• à¤•à¥‹ à¤¹à¤Ÿà¤¾à¤¨à¤¾ à¤šà¤¾à¤¹à¤¤à¥‡ à¤¹à¥ˆà¤‚?"
    }
};

// DOM Elements
const navLinks = document.querySelectorAll('.nav-link');
const pages = document.querySelectorAll('.page');
const darkModeToggle = document.getElementById('dark-mode-toggle');
const languageSelector = document.getElementById('language-selector');
const searchBar = document.getElementById('search-bar');
const booksContainer = document.getElementById('books-container');
const bookForm = document.getElementById('book-form');
const editModal = document.getElementById('edit-modal');
const editBookForm = document.getElementById('edit-book-form');
const closeModal = document.querySelector('.close');
const adminPanelBtn = document.getElementById('admin-panel-btn');

// State
let currentLanguage = 'en';
let currentUser = null;
let users = []; // Store registered users

// Sample books data
let books = [
    {
        id: 1,
        title: "Harry Potter and the Sorcerer's Stone",
        author: "J.K. Rowling",
        price: 20.00,
        image: "https://images.unsplash.com/photo-1544947950-fa07a98d237f?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=500&q=80"
    },
    {
        id: 2,
        title: "The Hobbit",
        author: "J.R.R. Tolkien",
        price: 18.00,
        image: "https://images.unsplash.com/photo-1629992101753-56d196c8aabb?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=500&q=80"
    },
    {
        id: 3,
        title: "To Kill a Mockingbird",
        author: "Harper Lee",
        price: 15.00,
        image: "https://images.unsplash.com/photo-1544947950-fa07a98d237f?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=500&q=80"
    },
    {
        id: 4,
        title: "1984",
        author: "George Orwell",
        price: 17.00,
        image: "https://images.unsplash.com/photo-1629992101753-56d196c8aabb?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=500&q=80"
    },
    {
        id: 5,
        title: "Pride and Prejudice",
        author: "Jane Austen",
        price: 14.00,
        image: "https://images.unsplash.com/photo-1544947950-fa07a98d237f?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=500&q=80"
    }
];

// Initialize the app
document.addEventListener('DOMContentLoaded', () => {
    // Load saved settings
    loadSettings();
    
    // Render books
    renderBooks();
    
    // Set up event listeners
    setupEventListeners();
    
    // Update auth UI
    updateAuthUI();
    
    // Show home page by default
    showPage('home');
});

// Set up event listeners
function setupEventListeners() {
    // Navigation
    navLinks.forEach(link => {
        link.addEventListener('click', (e) => {
            e.preventDefault();
            const pageId = link.getAttribute('href').substring(1);
            showPage(pageId);
        });
    });
    
    // Dark mode toggle
    darkModeToggle.addEventListener('click', toggleDarkMode);
    
    // Language selector
    languageSelector.addEventListener('change', (e) => {
        currentLanguage = e.target.value;
        saveSettings();
        translatePage();
    });
    
    // Search bar
    searchBar.addEventListener('input', filterBooks);
    
    // Book form submission
    bookForm.addEventListener('submit', addBook);
    
    // Edit book form submission
    editBookForm.addEventListener('submit', updateBook);
    
    // Close modal
    closeModal.addEventListener('click', () => {
        editModal.style.display = 'none';
    });
    
    // Close modal when clicking outside
    window.addEventListener('click', (e) => {
        if (e.target === editModal) {
            editModal.style.display = 'none';
        }
    });
    
    // Admin panel button
    adminPanelBtn.addEventListener('click', () => {
        showPage('admin');
    });
    
    // Login form
    document.getElementById('login-form').addEventListener('submit', (e) => {
        e.preventDefault();
        loginUser();
    });
    
    // Signup form
    document.getElementById('signup-form').addEventListener('submit', (e) => {
        e.preventDefault();
        registerUser();
    });
}

// Show a specific page
function showPage(pageId) {
    // Hide all pages
    pages.forEach(page => {
        page.classList.remove('active');
    });
    
    // Show the requested page
    const pageToShow = document.getElementById(pageId);
    if (pageToShow) {
        pageToShow.classList.add('active');
    }
    
    // Special handling for some pages
    if (pageId === 'books') {
        renderBooks();
    }
}

// Toggle dark mode
function toggleDarkMode() {
    document.body.classList.toggle('dark-mode');
    const isDarkMode = document.body.classList.contains('dark-mode');
    darkModeToggle.textContent = isDarkMode ? 'â˜€ï¸' : 'ðŸŒ™';
    saveSettings();
}

// Save settings to localStorage
function saveSettings() {
    const settings = {
        darkMode: document.body.classList.contains('dark-mode'),
        language: currentLanguage,
        users: users, // Save users
        currentUser: currentUser // Save current user
    };
    localStorage.setItem('librarySettings', JSON.stringify(settings));
}

// Load settings from localStorage
function loadSettings() {
    const settingsJSON = localStorage.getItem('librarySettings');
    if (settingsJSON) {
        const settings = JSON.parse(settingsJSON);
        
        // Apply dark mode
        if (settings.darkMode) {
            document.body.classList.add('dark-mode');
            darkModeToggle.textContent = 'â˜€ï¸';
        }
        
        // Apply language
        if (settings.language) {
            currentLanguage = settings.language;
            languageSelector.value = currentLanguage;
            translatePage();
        }
        
        // Load users
        if (settings.users) {
            users = settings.users;
        }
        
        // Load current user
        if (settings.currentUser) {
            currentUser = settings.currentUser;
            if (currentUser) {
                // Update UI to show logged in state
                updateAuthUI();
            }
        }
    }
}

// Update authentication UI
function updateAuthUI() {
    const loginNav = document.getElementById('login-nav');
    const signupNav = document.getElementById('signup-nav');
    const logoutNav = document.getElementById('logout-nav');
    
    if (currentUser) {
        // User is logged in
        if (loginNav) loginNav.style.display = 'none';
        if (signupNav) signupNav.style.display = 'none';
        if (logoutNav) logoutNav.style.display = 'block';
    } else {
        // User is not logged in
        if (loginNav) loginNav.style.display = 'block';
        if (signupNav) signupNav.style.display = 'block';
        if (logoutNav) logoutNav.style.display = 'none';
    }
}

// Register a new user
function registerUser() {
    const name = document.getElementById('signup-name').value;
    const email = document.getElementById('signup-email').value;
    const password = document.getElementById('signup-password').value;
    const confirmPassword = document.getElementById('signup-confirm-password').value;
    const termsAccepted = document.getElementById('terms').checked;
    
    // Validation
    if (!name || !email || !password || !confirmPassword) {
        alert('Please fill in all fields');
        return;
    }
    
    if (password !== confirmPassword) {
        alert('Passwords do not match');
        return;
    }
    
    if (!termsAccepted) {
        alert('Please accept the terms and conditions');
        return;
    }
    
    // Check if user already exists
    if (users.some(user => user.email === email)) {
        alert('User with this email already exists');
        return;
    }
    
    // Create new user
    const newUser = {
        id: Date.now(),
        name: name,
        email: email,
        password: password // In a real app, this should be hashed
    };
    
    // Add to users array
    users.push(newUser);
    
    // Save to localStorage
    saveSettings();
    
    // Show success message
    alert('Registration successful! Please log in.');
    
    // Reset form
    document.getElementById('signup-form').reset();
    
    // Redirect to login page
    showPage('login');
}

// Login user
function loginUser() {
    const email = document.getElementById('login-email').value;
    const password = document.getElementById('login-password').value;
    
    // Validation
    if (!email || !password) {
        alert('Please enter both email and password');
        return;
    }
    
    // Find user
    const user = users.find(u => u.email === email && u.password === password);
    
    if (user) {
        // Successful login
        currentUser = user;
        
        // Save to localStorage
        saveSettings();
        
        // Update UI
        updateAuthUI();
        
        // Show success message
        alert(`Welcome back, ${user.name}!`);
        
        // Redirect to home page
        showPage('home');
    } else {
        // Failed login
        alert('Invalid email or password');
    }
}

// Logout user
function logoutUser() {
    currentUser = null;
    saveSettings();
    updateAuthUI();
    showPage('home');
    alert('You have been logged out');
}

// Translate the page
function translatePage() {
    // Translate elements with data-translate attribute
    document.querySelectorAll('[data-translate]').forEach(element => {
        const key = element.getAttribute('data-translate');
        if (translations[currentLanguage][key]) {
            element.textContent = translations[currentLanguage][key];
        }
    });
    
    // Translate placeholders
    document.querySelectorAll('[data-translate-placeholder]').forEach(element => {
        const key = element.getAttribute('data-translate-placeholder');
        if (translations[currentLanguage][key]) {
            element.placeholder = translations[currentLanguage][key];
        }
    });
}

// Render books
function renderBooks(filter = '') {
    // Clear the container
    booksContainer.innerHTML = '';
    
    // Filter books if needed
    let filteredBooks = books;
    if (filter) {
        filteredBooks = books.filter(book => 
            book.title.toLowerCase().includes(filter.toLowerCase()) ||
            book.author.toLowerCase().includes(filter.toLowerCase())
        );
    }
    
    // Render each book
    filteredBooks.forEach(book => {
        const bookElement = document.createElement('div');
        bookElement.className = 'book-card';
        bookElement.innerHTML = `
            <img src="${book.image}" alt="${book.title}" class="book-image">
            <div class="book-info">
                <h3 class="book-title">${book.title}</h3>
                <p class="book-author">${book.author}</p>
                <p class="book-price">$${book.price.toFixed(2)}</p>
                <div class="book-actions">
                    <button class="btn btn-edit" onclick="openEditModal(${book.id})">${translations[currentLanguage].editBook}</button>
                    <button class="btn btn-delete" onclick="deleteBook(${book.id})">${translations[currentLanguage].deleteBook || 'Delete'}</button>
                    <button class="btn btn-add">${translations[currentLanguage].addBook}</button>
                </div>
            </div>
        `;
        booksContainer.appendChild(bookElement);
    });
}

// Filter books based on search input
function filterBooks() {
    const filterValue = searchBar.value;
    renderBooks(filterValue);
}

// Add a new book
function addBook(e) {
    e.preventDefault();
    
    const title = document.getElementById('book-title').value;
    const author = document.getElementById('book-author').value;
    const price = parseFloat(document.getElementById('book-price').value);
    const image = document.getElementById('book-image').value || 'https://images.unsplash.com/photo-1544947950-fa07a98d237f?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=500&q=80';
    
    // Create new book object
    const newBook = {
        id: Date.now(), // Unique ID
        title,
        author,
        price,
        image
    };
    
    // Add to books array
    books.push(newBook);
    
    // Re-render books
    renderBooks(searchBar.value);
    
    // Reset form
    bookForm.reset();
    
    // Show success message
    alert(`${translations[currentLanguage].addBook} ${title} ${translations[currentLanguage].success || 'added successfully!'}`);
}

// Open edit modal
function openEditModal(bookId) {
    const book = books.find(b => b.id === bookId);
    if (!book) return;
    
    // Populate form fields
    document.getElementById('edit-book-id').value = book.id;
    document.getElementById('edit-book-title').value = book.title;
    document.getElementById('edit-book-price').value = book.price;
    
    // Show modal
    editModal.style.display = 'block';
}

// Update book
function updateBook(e) {
    e.preventDefault();
    
    const id = parseInt(document.getElementById('edit-book-id').value);
    const title = document.getElementById('edit-book-title').value;
    const price = parseFloat(document.getElementById('edit-book-price').value);
    
    // Find and update the book
    const bookIndex = books.findIndex(b => b.id === id);
    if (bookIndex !== -1) {
        books[bookIndex].title = title;
        books[bookIndex].price = price;
        
        // Re-render books
        renderBooks(searchBar.value);
        
        // Close modal
        editModal.style.display = 'none';
        
        // Show success message
        alert(`${translations[currentLanguage].editBook} ${title} ${translations[currentLanguage].success || 'updated successfully!'}`);
    }
}

// Delete book
function deleteBook(bookId) {
    if (confirm(translations[currentLanguage].deleteConfirm)) {
        books = books.filter(book => book.id !== bookId);
        renderBooks(searchBar.value);
    }
}